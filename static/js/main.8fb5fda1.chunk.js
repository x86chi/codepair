(this.webpackJsonpcodepair=this.webpackJsonpcodepair||[]).push([[0],{146:function(e,t){},147:function(e,t){},192:function(e,t){},197:function(e,t){},294:function(e,t){},391:function(e,t){},445:function(e,t,n){},446:function(e,t,n){"use strict";n.r(t);var a,r,o,i=n(0),c=n.n(i),s=n(16),l=n.n(s),u=n(9),d=n(102),h=n(514),f=n(57),p=n(518),m=n(515),v=n(234),b=n(517),g=n(235),y=n(516),E=n(40),O=n(23),k=n(24),j=function(){function e(t){Object(O.a)(this,e),this.key=void 0,this.storage=void 0,this.key=t,this.storage=window.localStorage}return Object(k.a)(e,[{key:"getValue",value:function(e){try{return JSON.parse(this.storage[this.key])}catch(t){return e}}},{key:"setValue",value:function(e){this.storage[this.key]=JSON.stringify(e)}}]),e}();!function(e){e.Dark="dark",e.Light="light"}(a||(a={})),function(e){e.Sublime="sublime",e.Vim="vim",e.Emacs="emacs"}(r||(r={})),function(e){e.Two="2",e.Four="4",e.Eight="8"}(o||(o={}));var w=new j("$$codepair$$setting"),x=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,C=w.getValue({menu:{theme:x?a.Dark:a.Light,codeKeyMap:r.Sublime,tabSize:o.Two}}),S=Object(E.c)({name:"setting",initialState:C,reducers:{setDarkMode:function(e,t){e.menu.theme=t.payload?a.Dark:a.Light,w.setValue(e)},setCodeKeyMap:function(e,t){e.menu.codeKeyMap=t.payload,w.setValue(e)},setTabSize:function(e,t){e.menu.tabSize=t.payload,w.setValue(e)}}}),M=S.actions,D=M.setDarkMode,T=M.setCodeKeyMap,L=M.setTabSize,N=S.reducer,z=n(496),I=n(524),W=n(508),R=n(506),P=n(507),B=n(163),A=n(25),H=n(453),F=n(498),K=n(523),U=n(118),V=n.n(U),Y=n(492);function G(e){var t=e.anchorEl,n=e.onClose,a=e.children,r=e.anchorOrigin,o=e.transformOrigin,i=Boolean(t);return c.a.createElement(Y.a,{id:i?"simple-popover":void 0,open:i,anchorEl:t,onClose:n,anchorOrigin:r,transformOrigin:o},a)}G.defaultProps={anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}};var J,X=n(497),$=n(450),q=Object(z.a)((function(){return{root:function(e){return{color:e.peer.metadata.color}}}}));function _(e){var t=q(e),n=e.peer;return c.a.createElement($.a,{className:t.root},n.metadata.username)}!function(e){e.Connected="connected",e.Disconnected="disconnected"}(J||(J={}));var Q=Object(E.c)({name:"peer",initialState:{peers:{}},reducers:{syncPeer:function(e,t){for(var n=t.payload,a=n.myClientID,r=n.changedPeers,o=e.peers,i=0,c=Object.keys(o);i<c.length;i++){var s=c[i];r[s]||(o[s].status=J.Disconnected)}for(var l=0,u=Object.entries(r);l<u.length;l++){var d=Object(A.a)(u[l],2),h=d[0],f=d[1];if(!o[h]||o[h].status===J.Disconnected){var p={id:h,status:J.Connected,metadata:f,isMine:a===h};e.peers[h]=p}}}}}),Z=Q.actions.syncPeer,ee=Q.reducer;function te(){var e=Object(u.c)((function(e){return e.docState.client})),t=Object(u.c)((function(e){return e.peerState.peers}));return{activePeers:Object(i.useMemo)((function(){return e?Object.values(t).filter((function(e){return e.status===J.Connected})):[]}),[e,t])}}function ne(){var e=te().activePeers;return c.a.createElement(X.a,null,c.a.createElement($.a,null,c.a.createElement(B.a,null,"Total ",e.length)),e.map((function(e){return c.a.createElement(_,{key:e.id,peer:e})})))}var ae=Object(z.a)((function(e){return{group:{"& > *":{cursor:"pointer"}},myAvatar:{borderColor:e.palette.secondary.main}}}));function re(){var e=ae(),t=Object(u.c)((function(e){return e.docState.client})),n=te().activePeers,a=Object(i.useState)(),r=Object(A.a)(a,2),o=r[0],s=r[1],l=Object(i.useCallback)((function(e){e.target.getAttribute("data-id")||s(e.currentTarget)}),[s]),d=Object(i.useCallback)((function(){s(void 0)}),[s]);return t?c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{className:e.group,max:4,onClick:l},n.map((function(t){var n=t.metadata,a=n.username,r=n.color,o=n.image;return c.a.createElement(K.a,{key:t.id,title:t.isMine?"[ME] ".concat(a):a,"data-id":t.id,arrow:!0},c.a.createElement(H.a,{alt:"Peer Image",className:t.isMine?e.myAvatar:"",style:{backgroundColor:r},src:V.a.getImage(o)}))}))),c.a.createElement(G,{anchorEl:o,onClose:d},c.a.createElement(ne,null))):null}var oe=n(218),ie=n(519),ce=n(505),se=n(501),le=n(221),ue=n.n(le),de=n(222),he=n.n(de),fe=n(236),pe=n(5),me=n(526),ve=n(500),be=n(502),ge=n(503),ye=n(219),Ee=n.n(ye),Oe=n(499),ke=Object(pe.a)((function(e){return Object(I.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})}))((function(e){var t=e.children,n=e.classes,a=e.onClose,r=Object(fe.a)(e,["children","classes","onClose"]);return c.a.createElement(ve.a,Object.assign({disableTypography:!0,className:n.root},r),c.a.createElement(B.a,{variant:"h6"},t),a?c.a.createElement(se.a,{"aria-label":"close",className:n.closeButton,onClick:a},c.a.createElement(Ee.a,null)):null)})),je=Object(pe.a)((function(e){return{root:{padding:e.spacing(2)}}}))(be.a),we=Object(pe.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(ge.a);function xe(e){var t=e.open,n=e.onClose,a=e.className,r=e.children;return t?c.a.createElement(me.a,{onClose:n,open:t,maxWidth:"md"},c.a.createElement("div",{className:a},r)):null}xe.defaultProps={className:""};var Ce=xe,Se=n(504);function Me(e){var t=e.timeout,n=e.show,a=e.onFadeout,r=e.children,o=Object(i.useRef)(null);return Object(i.useEffect)((function(){return n&&(o.current=window.setTimeout((function(){a(),o.current=null}),t)),function(){o.current&&clearTimeout(o.current)}}),[n]),c.a.createElement(Se.a,{in:n},c.a.createElement("div",null,n?r:null))}Me.defaultProps={timeout:1e3};var De,Te,Le,Ne=Me,ze=n(55),Ie=n.n(ze),We=n(101),Re=n(130),Pe=n.n(Re),Be=n(220),Ae=n.n(Be);!function(e){e.HTML="html",e.Slide="slide"}(De||(De={})),function(e){e.Markdown="gfm",e.Go="go",e.JavaScript="javascript",e.Clojure="clojure",e.Dart="dart",e.Python="python",e.Ruby="ruby",e.Rust="rust"}(Te||(Te={})),function(e){e.Disconnect="disconnect",e.Connect="connect"}(Le||(Le={}));var He={mode:Te.Markdown,preview:De.HTML,loading:!0,errorMessage:"",status:Le.Connect},Fe=Object(E.b)("doc/activate",function(){var e=Object(We.a)(Ie.a.mark((function e(t,n){var a,r,o,i,c;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=V.a.generate(),r=a.name,o=a.animal,(i={apiKey:"",presence:{username:r,image:o,color:Ae()(),board:""}}).apiKey="".concat("cbovg64qfu96agb5i0fg"),c=new Pe.a.Client("".concat("https://api.yorkie.dev"),i),e.next=7,c.activate();case 7:return e.abrupt("return",{client:c});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",n.rejectWithValue(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()),Ke=Object(E.b)("doc/attach",function(){var e=Object(We.a)(Ie.a.mark((function e(t,n){var a,r;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,r=t.doc,e.prev=1,e.next=4,a.attach(r);case 4:return r.update((function(e){e.content||(e.content=new Pe.a.Text),e.shapes||(e.shapes=[])})),e.next=7,a.sync();case 7:return e.abrupt("return",{doc:r,client:a});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",n.rejectWithValue(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),Ue=Object(E.c)({name:"doc",initialState:He,reducers:{deactivateClient:function(e){var t=e.client;e.client=void 0,null===t||void 0===t||t.deactivate()},createDocument:function(e,t){e.doc=new Pe.a.Document("codepairs$".concat(t.payload))},detachDocument:function(e){var t=e.doc,n=e.client;e.doc=void 0,null===n||void 0===n||n.detach(t)},attachDocLoading:function(e,t){e.loading=t.payload},setCodeMode:function(e,t){e.mode=t.payload},setPreview:function(e,t){e.preview=t.payload},setStatus:function(e,t){e.status=t.payload}},extraReducers:function(e){e.addCase(Fe.fulfilled,(function(e,t){var n=t.payload;e.client=n.client})),e.addCase(Fe.rejected,(function(e,t){var n=t.payload;e.errorMessage=n})),e.addCase(Ke.fulfilled,(function(e,t){var n=t.payload;e.doc=n.doc,e.client=n.client})),e.addCase(Ke.rejected,(function(e,t){var n=t.payload;e.errorMessage=n}))}}),Ve=Ue.actions,Ye=Ve.deactivateClient,Ge=Ve.createDocument,Je=Ve.detachDocument,Xe=Ve.attachDocLoading,$e=Ve.setPreview,qe=Ve.setCodeMode,_e=Ve.setStatus,Qe=Ue.reducer,Ze=Object(z.a)((function(){return{dialog:{borderRadius:"4px"},input:{width:"300px",padding:"12px 8px",fontSize:"18px",borderRadius:"5px",outline:"none",backgroundColor:"hsla(0,0%,100%,0.9)"},box:{"@media only screen and (max-width: 600px)":{display:"none"}},button:{lineHeight:"32px"}}}));function et(){var e=Ze(),t=Object(u.c)((function(e){return e.docState.status})),n=Object(i.useState)(!1),a=Object(A.a)(n,2),r=a[0],o=a[1],s=Object(i.useState)(!1),l=Object(A.a)(s,2),d=l[0],h=l[1],f=Object(i.useRef)(null),p=window.location.href.split("?")[0],m=Object(i.useCallback)((function(){var e;null===(e=f.current)||void 0===e||e.select()}),[]),v=Object(i.useCallback)((function(){h(!0)}),[]),b=Object(i.useCallback)((function(){o(!0)}),[]),g=Object(i.useCallback)((function(){o(!1)}),[]);return c.a.createElement("div",{className:e.box},c.a.createElement(ce.a,{className:e.button,size:"small",color:"primary",variant:"contained",startIcon:c.a.createElement(ue.a,null),onClick:b,disabled:t===Le.Disconnect},"Share"),c.a.createElement(Ce,{open:r,onClose:g,className:e.dialog},c.a.createElement(ke,{onClose:g},"Share Code"),c.a.createElement(je,{dividers:!0},c.a.createElement(ie.a,{my:3},c.a.createElement(B.a,null,"Anyone can access the code in real time through this URL.")),c.a.createElement(ie.a,{my:1},c.a.createElement(Oe.a,null,"Share this URL")),c.a.createElement(ie.a,{display:"flex"},c.a.createElement("input",{readOnly:!0,ref:f,className:e.input,value:p,onFocus:m}),c.a.createElement(oe.CopyToClipboard,{text:p,onCopy:v},c.a.createElement(se.a,{color:"primary"},c.a.createElement(he.a,null))),c.a.createElement(Ne,{show:d,onFadeout:function(){return h(!1)}},c.a.createElement("p",null,"Copy!")))),c.a.createElement(we,null,c.a.createElement(ce.a,{onClick:g,color:"primary",variant:"contained",autoFocus:!0},"Close"))))}var tt=n(224),nt=n.n(tt),at=n(223),rt=n.n(at),ot=Object(z.a)((function(){return Object(I.a)({root:{width:"380px"},title:{backgroundColor:"hsla(0,0%,100%,0.1)","& > *":{fontWeight:"bold"}}})}));function it(e){var t=e.title,n=e.subTitle,a=e.content,r=ot();return c.a.createElement("div",{className:r.root},c.a.createElement(ie.a,{px:2,py:1.5,className:r.title},c.a.createElement(B.a,{variant:"subtitle1"},t)),c.a.createElement(ie.a,{px:2,p:1},c.a.createElement(ie.a,{py:1},c.a.createElement(B.a,{variant:"body1"},n)),c.a.createElement(ie.a,{pb:2.5},c.a.createElement(B.a,{variant:"body2"},a))))}function ct(e){var t=Object(i.useState)(),n=Object(A.a)(t,2),a=n[0],r=n[1],o=e.hasLocalChanges,s=Object(i.useCallback)((function(e){r(e.currentTarget)}),[]),l=Object(i.useCallback)((function(){r(void 0)}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ce.a,{"aria-label":"doc-status",color:"secondary",startIcon:c.a.createElement(rt.a,null),onClick:s},"Working offline"),c.a.createElement(G,{anchorEl:a,onClose:l,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},c.a.createElement(it,{title:o?"There are changes that couldn't be sent to Server":"All Changes saved to Server",subTitle:"This document is ready for offline use",content:"Looks like you're offline. Changes will save to this memory now, and save to Server once reconnected."})))}function st(){var e=Object(i.useState)(),t=Object(A.a)(e,2),n=t[0],a=t[1],r=Object(i.useCallback)((function(e){a(e.currentTarget)}),[]),o=Object(i.useCallback)((function(){a(void 0)}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ce.a,{"aria-label":"doc-status",color:"secondary",onClick:r},c.a.createElement(nt.a,null)),c.a.createElement(G,{anchorEl:n,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},c.a.createElement(it,{title:"All Changes saved to Server",subTitle:"This document is ready for offline use",content:"You can edit this document without an internet connection. Changes will save to Server once reconnected."})))}function lt(){var e=Object(u.c)((function(e){return e.docState.status})),t=Object(u.c)((function(e){return!!e.docState.doc&&e.docState.doc.hasLocalChanges()}));return e===Le.Connect?c.a.createElement(st,null):c.a.createElement(ct,{hasLocalChanges:t})}var ut=Object(z.a)((function(e){return Object(I.a)({root:{flexGrow:1},appBar:{backgroundColor:"black"},grow:{flexGrow:1},title:{fontWeight:"bold",color:e.palette.primary.main,marginRight:e.spacing(1)},yorkie:{"& > a":{textDecoration:"none",color:"#b5b0a1",fontSize:12}},items:{display:"flex","& > *":{margin:e.spacing(1)}}})}));function dt(){var e=ut();return c.a.createElement("div",{className:e.root},c.a.createElement(R.a,{position:"static",className:e.appBar},c.a.createElement(P.a,null,c.a.createElement(B.a,{variant:"h6",className:e.title},c.a.createElement(W.a,{href:"/",underline:"none"},"CodePair")),c.a.createElement(B.a,{className:e.yorkie},c.a.createElement("a",{href:"https://yorkie.dev",target:"_blank",rel:"noreferrer"},"Powered by Yorkie")),c.a.createElement(lt,null),c.a.createElement("div",{className:e.grow}),c.a.createElement("div",{className:e.items},c.a.createElement(et,null),c.a.createElement(re,null)))))}var ht,ft=Object(i.memo)(dt),pt=n(522),mt=n(521),vt=n(513),bt=n(36),gt=n(225),yt=n.n(gt),Et=n(226),Ot=n.n(Et);!function(e){e.Deactivated="deactivated",e.Activated="activated"}(ht||(ht={}));var kt=function(){function e(t,n){Object(O.a)(this,e),this.id=void 0,this.username=void 0,this.color=void 0,this.height=void 0,this.marker=void 0,this.lineMarker=void 0,this.status=void 0,this.nameRemoveTimeMap=void 0,this.nameAnimationDelay=void 0,this.nameAnimationDuration=void 0,this.nameRemoveTime=void 0,this.id=t,this.username=n.username,this.color=n.color,this.height=0,this.status=ht.Deactivated,this.nameRemoveTimeMap=new Map,this.nameAnimationDelay=1,this.nameAnimationDuration=.2,this.nameRemoveTime=1e3*(this.nameAnimationDuration+this.nameAnimationDelay)}return Object(k.a)(e,[{key:"updateCursor",value:function(e,t){this.removeCursor(),this.status=ht.Activated;var n=e.cursorCoords(t),a=document.createElement("span");this.height=n.bottom-n.top,a.classList.add("codePair-cursor"),a.style.borderLeftColor=this.color,a.style.height="".concat(this.height,"px"),this.marker=e.setBookmark(t,{widget:a,insertLeft:!0}),this.showCursorNameReserve(a)}},{key:"updateLine",value:function(e,t,n){this.removeLine(),this.status=ht.Activated;var a=parseInt(this.color.slice(1,3),16),r=parseInt(this.color.slice(3,5),16),o=parseInt(this.color.slice(5,7),16),i="rgba(".concat(a,", ").concat(r,", ").concat(o,", 0.15)");this.lineMarker=e.getDoc().markText(t,n,{css:"background-color : ".concat(i,";")})}},{key:"showCursorNameReserve",value:function(e){var t=this,n=document.createElement("span");n.classList.add("codePair-name"),e.addEventListener("mouseenter",(function(){t.nameRemoveTimeMap.has(t.id)&&clearTimeout(t.nameRemoveTimeMap.get(t.id)),n.textContent=t.username,n.style.top="-".concat(t.height,"px"),n.style.backgroundColor=t.color,n.style.color=Ot()(t.color,!0),n.classList.remove("text-remove"),e.appendChild(n)})),e.addEventListener("mouseleave",(function(){n.classList.add("text-remove"),n.style.animationDuration="".concat(t.nameAnimationDuration,"s"),n.style.animationDelay="".concat(t.nameAnimationDelay,"s"),t.removeNameReserve(n)}))}},{key:"removeNameReserve",value:function(e){var t=this,n=setTimeout((function(){e.parentNode.removeChild(e),t.nameRemoveTimeMap.delete(t.id)}),this.nameRemoveTime);this.nameRemoveTimeMap.set(this.id,n)}},{key:"removeCursor",value:function(){this.marker&&(this.marker.clear(),this.marker=void 0)}},{key:"removeLine",value:function(){this.lineMarker&&(this.lineMarker.clear(),this.lineMarker=void 0)}},{key:"clear",value:function(){this.removeCursor(),this.removeLine()}},{key:"isActive",value:function(){return this.status===ht.Activated}}]),e}(),jt=n(227),wt=function(){function e(t){Object(O.a)(this,e),this.marpit=void 0,this.theme=void 0,this.marpit=new jt.Marpit({inlineSVG:!0}),this.theme=t;this.marpit.themeSet.default=this.marpit.themeSet.add("\n    /* @theme example */\n      section {\n      background-color: #000;\n      color: #fff;\n      font-size: 30px;\n      padding: 40px;\n      margin: 10px;\n      border: 10px solid black;\n    }\n\n    h1, h2 {\n      text-align: center;\n      margin: 0;\n    }\n\n    h1 {\n      color: #fff;\n    }\n    ")}return Object(k.a)(e,[{key:"render",value:function(e){return this.marpit.render(e)}}]),e}(),xt=(n(439),n(440),n(441),n(442),n(7)),Ct=n.n(xt);Ct.a.Vim.defineEx("shuffle","shuf",(function(e,t){var n=t.line||e.firstLine(),a=t.lineEnd||t.line||e.lastLine();if(n!==a){for(var r=new Ct.a.Pos(n,0),o=new Ct.a.Pos(a,e.getLine(a).length),i=e.getRange(r,o).split("\n"),c=i.length-1;c>0;c-=1){var s=Math.floor(Math.random()*(c+1)),l=[i[s],i[c]];i[c]=l[0],i[s]=l[1]}e.replaceRange(i.join("\n"),r,o)}}));var St,Mt,Dt=Object(z.a)((function(e){return Object(I.a)({dark:{"& .CodeMirror":{color:e.palette.common.white,borderColor:e.palette.background.paper,backgroundColor:e.palette.background.paper},"& .CodeMirror-cursor":{borderLeftColor:e.palette.common.white,color:e.palette.common.white},"& .editor-toolbar":{backgroundColor:"#303030"},"& .editor-toolbar > *":{color:e.palette.common.white},"& .editor-toolbar > .active, .editor-toolbar > button:hover, .editor-preview pre, .cm-s-easymde":{backgroundColor:e.palette.background.paper},"& .editor-preview":{backgroundColor:e.palette.background.default},"& .CodeMirror-line span.cm-keyword":{color:"#f92672"},"& .CodeMirror-line span.cm-atom":{color:"#ae81ff"},"& .CodeMirror-line span.cm-number":{color:"#ae81ff"},"& .CodeMirror-line span.cm-def":{color:"#bc9262"},"& .CodeMirror-line span.cm-variable":{color:"#f8f8f2"},"& .CodeMirror-line span.cm-property":{color:"#a6e22e"},"& .CodeMirror-line span.cm-operator":{color:"#fff"},"& .CodeMirror-line span.cm-string":{color:"#e6db74"},"& .CodeMirror-line span.cm-string-2":{color:"#e6db74"},"& .CodeMirror-line span.cm-meta":{color:"#555"},"& .CodeMirror-line span.cm-error":{background:"#f92672",color:"#f8f8f0"},"& .CodeMirror-line span.cm-qualifier":{color:"#555"},"& .CodeMirror-line span.cm-builtin":{color:"#66d9ef"},"& .CodeMirror-line span.cm-bracket":{color:"#f8f8f2"},"& .CodeMirror-line span.cm-tag":{color:"#bc6283"},"& .CodeMirror-line span.cm-attribute":{color:"#97b757"},"& .CodeMirror-line span.cm-hr":{color:"#999"}}})}));function Tt(e){var t=e.forwardedRef,n=Dt(),r=Object(u.c)((function(e){return e.docState.doc})),o=Object(u.c)((function(e){return e.docState.preview})),s=Object(u.c)((function(e){return e.settingState.menu})),l=Object(u.c)((function(e){return e.docState.client})),d=Object(u.c)((function(e){return e.peerState.peers})),h=Object(i.useRef)(new Map),f=Object(i.useState)(null),p=Object(A.a)(f,2),m=p[0],v=p[1],b=Object(i.useCallback)((function(e,t){h.current.set(e,new kt(e,t))}),[]),g=Object(i.useCallback)((function(e){h.current.has(e)&&(h.current.get(e).clear(),h.current.delete(e))}),[]),y=Object(i.useCallback)((function(e){v(e)}),[]);Object(i.useEffect)((function(){for(var e=0,t=Object.entries(d);e<t.length;e++){var n=Object(A.a)(t[e],2),a=n[0],r=n[1];h.current.has(a)&&r.status===J.Disconnected?g(a):h.current.has(a)||r.status!==J.Connected||b(a,r.metadata)}}),[d]),Object(i.useEffect)((function(){if(l&&r&&m){t.current=m;var e=function(e,t){var n=h.current.get(e);null===n||void 0===n||n.updateCursor(m,t)},n=function(){};r.subscribe((function(t){if("remote-change"===t.type){var a,r=Object(bt.a)(t.value);try{for(r.s();!(a=r.n()).done;){var o=a.value.change.getID().getActorID();if(o!==l.getID()){if(!h.current.has(o))return;if(h.current.get(o).isActive())return;e(o,m.posFromIndex(0))}}}catch(i){r.e(i)}finally{r.f()}}else"snapshot"===t.type&&n()})),m.on("beforeChange",(function(e,t){if("yorkie"!==t.origin&&"setValue"!==t.origin){var n=m.indexFromPos(t.from),a=m.indexFromPos(t.to),o=t.text.join("\n");r.update((function(e){e.content.edit(n,a,o)}))}})),m.on("beforeSelectionChange",(function(e,t){if(t.origin){var n=m.indexFromPos(t.ranges[0].anchor),a=m.indexFromPos(t.ranges[0].head);r.update((function(e){e.content.select(n,a)}))}}));var a=function(t){t.forEach((function(t){var n=t.actor,a=t.from,r=t.to;if("content"===t.type){var o=t.content||"";if(n!==l.getID()){var i=m.posFromIndex(a),c=m.posFromIndex(r);m.replaceRange(o,i,c,"yorkie")}}else if("selection"===t.type&&n!==l.getID()){var s=m.posFromIndex(a),u=m.posFromIndex(r);if(e(n,u),a>r){var d=[s,u];u=d[0],s=d[1]}!function(e,t,n){var a=h.current.get(e);null===a||void 0===a||a.updateLine(m,t,n)}(n,s,u)}}))};(n=function(){var e=r.getRoot().content;e.onChanges(a),m.setValue(e.toString())})(),m.addKeyMap(s.codeKeyMap),m.setOption("keyMap",s.codeKeyMap),m.getDoc().clearHistory(),m.focus()}}),[m]);var E=Object(i.useMemo)((function(){var e={spellChecker:!1,placeholder:"Write code here and share...",tabSize:Number(s.tabSize),maxHeight:"calc(100vh - ".concat(Zn+70,"px)"),toolbar:["bold","italic","|","unordered-list","ordered-list","|","code","link","image","table","|","side-by-side","preview","fullscreen"],unorderedListStyle:"-",status:!1,shortcuts:{toggleUnorderedList:null}};if(o===De.Slide){var t=new wt(s.theme);e.previewRender=function(e,n){var a=t.render(e),r=a.html,o=a.css,i=this;return setTimeout((function(){i.style||(i.style=document.createElement("style"),document.head.appendChild(i.style)),i.style.innerHTML=o,n.innerHTML=r}),20),null}}return e}),[o]);return c.a.createElement(yt.a,{className:s.theme===a.Dark?n.dark:"",getCodemirrorInstance:y,options:E})}!function(e){e.Red="#d8453c",e.Blue="#19abbf",e.Green="#699e3d",e.White="#cccccc",e.Yellow="#f3b328",e.Black="#444"}(St||(St={})),function(e){e[e.None=0]="None",e[e.Line=1]="Line",e[e.Eraser=2]="Eraser",e[e.Rect=3]="Rect",e[e.Selector=4]="Selector",e[e.Clear=5]="Clear"}(Mt||(Mt={}));var Lt={isOpen:!1,color:St.Yellow,toolType:Mt.None},Nt=Object(E.c)({name:"board",initialState:Lt,reducers:{toggleBoard:function(e){e.isOpen=!e.isOpen},setTool:function(e,t){e.toolType=t.payload},setColor:function(e,t){e.color=t.payload}}}),zt=Nt.actions,It=(zt.toggleBoard,zt.setTool),Wt=zt.setColor,Rt=Nt.reducer,Pt=n(45),Bt=n(43),At=function(){function e(t){Object(O.a)(this,e),this.name=void 0,this.callbacks=void 0,this.name=t,this.callbacks=[]}return Object(k.a)(e,[{key:"on",value:function(e){this.callbacks.push(e)}},{key:"off",value:function(e){var t=this.callbacks.findIndex((function(t){return t===e}));this.callbacks.splice(t,1)}},{key:"toString",value:function(){return this.name}}]),e}(),Ht=function(){function e(){Object(O.a)(this,e),this.events=void 0,this.events={}}return Object(k.a)(e,[{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.events[e]&&this.events[e].callbacks.forEach((function(e){e.apply(void 0,n)}))}},{key:"addEventListener",value:function(e,t){this.events[e]||(this.events[e]=new At(e)),this.events[e].on(t)}},{key:"removeEventListener",value:function(e,t){t?this.events[e].off(t):delete this.events[e]}}]),e}(),Ft=function(){function e(t){Object(O.a)(this,e),this.canvas=void 0,this.context=void 0,this.width=0,this.height=0,this.canvas=t,this.context=t.getContext("2d"),this.context.lineWidth=3,this.context.lineCap="round",this.canvas.className="canvas",this.setWidth(t.width),this.setHeight(t.height)}return Object(k.a)(e,[{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.context}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"setWidth",value:function(e,t){this.width=e,this.canvas.width=t?e*t:e,this.canvas.style.width="".concat(e,"px")}},{key:"setHeight",value:function(e,t){this.height=e,this.canvas.height=t?e*t:e,this.canvas.style.height="".concat(e,"px")}},{key:"setSize",value:function(e,t,n){this.setWidth(e,n),this.setHeight(t,n)}},{key:"clear",value:function(){this.getContext().clearRect(0,0,this.getWidth(),this.getHeight())}},{key:"resize",value:function(){var e=window.devicePixelRatio;e?(this.setSize(this.width,this.height,e),this.context.scale(e,e)):this.setSize(this.width,this.height)}}]),e}(),Kt=n(228),Ut=n.n(Kt);function Vt(e,t){if(!(t.points.length<3)){var n,a=[],r=Object(bt.a)(t.points);try{for(r.s();!(n=r.n()).done;){var o=n.value;a.push([o.x,o.y])}}catch(d){r.e(d)}finally{r.f()}var i=Ut()(a,2);if(i.length){e.save(),e.beginPath(),e.strokeStyle=t.color||"#ff7043";var c=i[0];e.moveTo(c[0][0],c[0][1]);var s,l=Object(bt.a)(i);try{for(l.s();!(s=l.n()).done;){var u=s.value;e.bezierCurveTo(u[1][0],u[1][1],u[2][0],u[2][1],u[3][0],u[3][1])}}catch(d){l.e(d)}finally{l.f()}e.stroke(),e.closePath(),e.restore()}}}function Yt(e,t){e.save(),e.beginPath(),e.strokeStyle="#ff7043";var n,a=!1,r=Object(bt.a)(t.points);try{for(r.s();!(n=r.n()).done;){var o=n.value;!1===a?(a=!0,e.moveTo(o.x,o.y)):e.lineTo(o.x,o.y)}}catch(i){r.e(i)}finally{r.f()}e.stroke(),e.closePath(),e.restore()}function Gt(e){return{y:e.y+8,x:e.x+6}}function Jt(e,t){var n=e.x-t.x,a=e.y-t.y;return n*n+a*a}function Xt(e,t,n){var a=t.x,r=t.y,o=n.x-a,i=n.y-r;if(0!==o||0!==i){var c=((e.x-a)*o+(e.y-r)*i)/(o*o+i*i);c>1?(a=n.x,r=n.y):c>0&&(a+=o*c,r+=i*c)}return(o=e.x-a)*o+(i=e.y-r)*i}function $t(e,t,n,a,r){for(var o=a,i=0,c=t+1;c<n;c+=1){var s=Xt(e[c],e[t],e[n]);s>o&&(i=c,o=s)}o>a&&(t+1<i&&$t(e,t,i,a,r),r.push(e[i]),i+1<n&&$t(e,i,n,a,r))}function qt(e,t){var n=e.length-1,a=[];return a.push(e[0]),$t(e,0,n,t,a),a.push(e[n]),a}function _t(e,t){for(var n=e[0],a=n,r=[a],o=1,i=e.length;o<i;o+=1)Jt(n=e[o],a)>t&&(r.push(n),a=n);return a!==n&&r.push(n),r}function Qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return qt(_t(e,t),t)}function Zt(e,t,n,a){var r,o,i={x:0,y:0,onLine1:!1,onLine2:!1},c=(a.y-n.y)*(t.x-e.x)-(a.x-n.x)*(t.y-e.y);if(0===c)return i;r=e.y-n.y,o=e.x-n.x;var s=(a.x-n.x)*r-(a.y-n.y)*o,l=(t.x-e.x)*r-(t.y-e.y)*o;return r=s/c,o=l/c,i.x=e.x+r*(t.x-e.x),i.y=e.y+r*(t.y-e.y),r>0&&r<1&&(i.onLine1=!0),o>0&&o<1&&(i.onLine2=!0),i}function en(e){return{y:e.y,x:e.x,width:e.width,height:e.height}}function tn(e,t){var n=e.y+e.height,a=e.x+e.width;return!(e.height>0?n<t.y:n>t.y)&&(!(e.y>t.y)&&(!(e.height>0?a<t.x:a>t.x)&&!(e.x>t.x)))}function nn(e){return"rect"===e.type}function an(e,t){e.save(),e.strokeStyle=t.color,e.strokeRect(t.box.x,t.box.y,t.box.width,t.box.height),e.restore()}function rn(e,t,n,a){return e.addEventListener(t,n,a)}function on(e,t,n,a){return e.removeEventListener(t,n,a)}var cn={mouseup:"touchend",mouseout:"touchend",mousedown:"touchstart",mousemove:"touchmove"};function sn(e,t,n,a){t(e,cn[n],a),t(e,n,a)}var ln,un,dn=n(103),hn=n(89),fn=function(){function e(t){Object(O.a)(this,e),this.options=void 0,this.type=void 0,this.update=void 0,this.options=t}return Object(k.a)(e,[{key:"getElementByID",value:function(e,t){return e.shapes.getElementByID(t)}},{key:"deleteByID",value:function(e,t){return e.shapes.deleteByID(t)}},{key:"clearAll",value:function(){var e=this;this.update((function(t){var n,a=Object(bt.a)(t.shapes);try{for(a.s();!(n=a.n()).done;){var r=n.value;e.deleteByID(t,r.getID())}}catch(o){a.e(o)}finally{a.f()}}))}},{key:"setOption",value:function(e){this.options=Object(hn.a)(Object(hn.a)({},this.options),e)}}]),e}(),pn=[],mn=function(){"function"===typeof un&&(un(pn),pn=[])};function vn(e){e?mn():ln=setTimeout((function(){mn(),vn(!1)}),50)}function bn(e,t){pn.push(e),void 0===un&&(un=t,vn(!1))}function gn(){clearTimeout(ln),"function"===typeof un&&vn(!0),un=void 0}var yn,En=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a,r){var o;return Object(O.a)(this,n),(o=t.call(this,r)).type=Mt.Line,o.update=void 0,o.board=void 0,o.createID=void 0,o.update=e,o.board=a,o}return Object(k.a)(n,[{key:"mousedown",value:function(e){var t,n=this;this.update((function(a){var r,o=function(e,t){return{type:"line",color:t,points:[e]}}(e,null===(r=n.options)||void 0===r?void 0:r.color);a.shapes.push(o);var i=a.shapes.getLast();t=i.getID()})),this.createID=t}},{key:"mousemove",value:function(e){var t=this;bn(e,(function(e){var n=Qt(e);e.length<2||t.update((function(e){var a,r=t.getElementByID(e,t.createID);r&&((a=r.points).push.apply(a,Object(dn.a)(n)),t.board.drawAll(e.shapes))}))}))}},{key:"mouseup",value:function(){this.flushTask()}},{key:"flushTask",value:function(){var e=this;gn(),this.update((function(t){if(e.createID){var n=e.getElementByID(t,e.createID);n&&(n.points.length<2&&e.deleteByID(t,e.createID),e.board.drawAll(t.shapes))}}))}}]),n}(fn),On=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a,r){var o;return Object(O.a)(this,n),(o=t.call(this,r)).type=Mt.Rect,o.update=void 0,o.board=void 0,o.createID=void 0,o.update=e,o.board=a,o}return Object(k.a)(n,[{key:"mousedown",value:function(e){var t,n=this;this.update((function(a){var r=function(e,t){return{type:"rect",color:t.color,box:{x:e.x,y:e.y,width:0,height:0},points:[{x:e.x,y:e.y}]}}(e,n.options);a.shapes.push(r);var o=a.shapes.getLast();t=o.getID()})),this.createID=t}},{key:"mousemove",value:function(e){var t=this;bn(e,(function(e){e.length<2||t.update((function(n){var a=e[e.length-1],r=t.getElementByID(n,t.createID);if(r){var o=function(e,t){var n=en(e.box),a=e.points[0],r=t.x-a.x,o=t.y-a.y,i=Math.abs(r),c=Math.abs(o);return n.x=a.x-(r>0?0:-r),n.y=a.y-(o>0?0:-o),n.width=i,n.height=c,n}(r,a);r.box=o,t.board.drawAll(n.shapes)}}))}))}},{key:"mouseup",value:function(){this.flushTask()}},{key:"flushTask",value:function(){gn()}}]),n}(fn),kn=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a){var r;return Object(O.a)(this,n),(r=t.call(this)).type=Mt.Eraser,r.update=void 0,r.board=void 0,r.eraserBoxSize=24,r.selectPoint=[],r.update=e,r.board=a,r}return Object(k.a)(n,[{key:"mousedown",value:function(e,t){this.selectPoint=[e,e],t({eraserPoints:Object(dn.a)(this.selectPoint)})}},{key:"mousemove",value:function(e,t){var n=this;bn(e,(function(e){var a=Qt(e);e.length<2||n.update((function(e){var r=Gt(a[0]),o=Gt(a[a.length-1]),i=function(t,a){var r,o=Object(bt.a)(e.shapes);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("eraser"!==i.type)if(nn(i))tn(i.box,a)&&n.deleteByID(e,i.getID());else for(var c=1;c<i.points.length;c+=1){var s=i.points[c-1],l=i.points[c];if(tn(n.eraserBox(a),l)){n.deleteByID(e,i.getID());break}if(tn(n.eraserBox(t),l)){n.deleteByID(e,i.getID());break}var u=Zt(t,a,s,l);if(u.onLine1&&u.onLine2){n.deleteByID(e,i.getID());break}}}}catch(d){o.e(d)}finally{o.f()}};n.selectPoint.length>0&&i(n.selectPoint[n.selectPoint.length-1],r);i(r,o),n.board.drawAll(e.shapes),n.selectPoint=[r,o],t({eraserPoints:Object(dn.a)(n.selectPoint)})}))}))}},{key:"mouseup",value:function(){this.flushTask()}},{key:"flushTask",value:function(){gn(),this.selectPoint=[]}},{key:"eraserBox",value:function(e){var t=e.x-this.eraserBoxSize/2;return{y:e.y-this.eraserBoxSize/2,x:t,width:this.eraserBoxSize,height:this.eraserBoxSize}}}]),n}(fn),jn=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a){var r;return Object(O.a)(this,n),(r=t.call(this)).type=Mt.Selector,r.update=void 0,r.board=void 0,r.selectedShape=void 0,r.update=e,r.board=a,r}return Object(k.a)(n,[{key:"mousedown",value:function(e){var t=this.findTarget(e);this.selectedShape=t?{shape:t,point:e}:void 0}},{key:"mousemove",value:function(e){var t=this;bn(e,(function(e){e.length<2||t.update((function(n){if(!t.isEmptySelectedShape()){var a=t.getElementByID(n,t.selectedShape.shape.getID());if(a&&"rect"===a.type){if(nn(a)){var r=e[e.length-1],o=r.y-t.selectedShape.point.y,i=r.x-t.selectedShape.point.x;t.selectedShape.point=r,a.box=Object(hn.a)(Object(hn.a)({},en(a.box)),{},{y:a.box.y+o,x:a.box.x+i}),a.points[0]={y:a.points[0].y+o,x:a.points[0].x+i}}t.board.drawAll(n.shapes)}}}))}))}},{key:"mouseup",value:function(){this.flushTask()}},{key:"flushTask",value:function(){gn()}},{key:"isEmptySelectedShape",value:function(){return!this.selectedShape}},{key:"findTarget",value:function(e){var t;return this.update((function(n){var a,r=Object(bt.a)(n.shapes);try{for(r.s();!(a=r.n()).done;){var o=a.value;if("rect"===o.type&&tn(o.box,e))return void(t=o)}}catch(i){r.e(i)}finally{r.f()}})),t}}]),n}(fn),wn=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a){var r;return Object(O.a)(this,n),(r=t.call(this)).type=Mt.None,r.update=void 0,r.board=void 0,r.update=e,r.board=a,r}return Object(k.a)(n,[{key:"mousedown",value:function(){}},{key:"mousemove",value:function(){}},{key:"mouseup",value:function(){}},{key:"flushTask",value:function(){}}]),n}(fn);!function(e){e[e.Drag=0]="Drag",e[e.Stop=1]="Stop"}(yn||(yn={}));var xn=function(e){Object(Pt.a)(n,e);var t=Object(Bt.a)(n);function n(e,a){var r;return Object(O.a)(this,n),(r=t.call(this)).offsetY=0,r.offsetX=0,r.color=St.Black,r.dragStatus=yn.Stop,r.lowerWrapper=void 0,r.upperWrapper=void 0,r.metadataMap=new Map,r.update=void 0,r.worker=void 0,r.lowerWrapper=new Ft(e),r.upperWrapper=r.createUpperWrapper(),r.update=a,r.initialize(),r}return Object(k.a)(n,[{key:"initialize",value:function(){this.initializeSize(),this.initializeOffset(),this.emit=this.emit.bind(this),this.drawAll=this.drawAll.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.worker=new wn(this.update,this),sn(this.upperWrapper.getCanvas(),rn,"mouseup",this.onMouseUp),sn(this.upperWrapper.getCanvas(),rn,"mouseout",this.onMouseOut),sn(this.upperWrapper.getCanvas(),rn,"mousedown",this.onMouseDown),this.addEventListener("renderAll",this.drawAll)}},{key:"destroy",value:function(){sn(this.upperWrapper.getCanvas(),on,"mouseup",this.onMouseUp),sn(this.upperWrapper.getCanvas(),on,"mouseout",this.onMouseOut),sn(this.upperWrapper.getCanvas(),on,"mousedown",this.onMouseDown),this.destroyUpperCanvas(),this.removeEventListener("renderAll")}},{key:"initializeOffset",value:function(){var e=this.lowerWrapper.getCanvas().getBoundingClientRect(),t=e.y,n=e.x;this.offsetY=t,this.offsetX=n}},{key:"initializeSize",value:function(){this.lowerWrapper.resize(),this.upperWrapper.resize()}},{key:"createUpperWrapper",value:function(){var e,t=document.createElement("canvas"),n=new Ft(t);return n.setWidth(this.lowerWrapper.getWidth()),n.setHeight(this.lowerWrapper.getHeight()),null===(e=this.lowerWrapper.getCanvas().parentNode)||void 0===e||e.appendChild(t),n}},{key:"destroyUpperCanvas",value:function(){var e,t,n=null===(e=this.upperWrapper)||void 0===e?void 0:e.getCanvas();n&&(null===(t=n.parentNode)||void 0===t||t.removeChild(n))}},{key:"setColor",value:function(e){this.color=e,this.worker.setOption({color:e})}},{key:"setWidth",value:function(e){this.lowerWrapper.setWidth(e),this.upperWrapper.setWidth(e),this.resize()}},{key:"setHeight",value:function(e){this.lowerWrapper.setHeight(e),this.upperWrapper.setHeight(e),this.resize()}},{key:"resize",value:function(){this.lowerWrapper.resize(),this.upperWrapper.resize()}},{key:"setTool",value:function(e){this.setMouseClass(e),this.worker.type!==e&&(this.worker.flushTask(),this.worker=this.createWorker(e))}},{key:"createWorker",value:function(e){if(e===Mt.Line)return new En(this.update,this,{color:this.color});if(e===Mt.Eraser)return new kn(this.update,this);if(e===Mt.Rect)return new On(this.update,this,{color:this.color});if(e===Mt.Selector)return new jn(this.update,this);if(e===Mt.None||e===Mt.Clear)return new wn(this.update,this);throw new TypeError("Undefined tool: ".concat(e))}},{key:"setMouseClass",value:function(e){this.upperWrapper.getCanvas().className="canvas canvas-upper",e===Mt.Line||e===Mt.Rect?this.upperWrapper.getCanvas().classList.add("crosshair","canvas-touch-none"):e===Mt.Eraser?this.upperWrapper.getCanvas().classList.add("eraser","canvas-touch-none"):e===Mt.Selector&&this.upperWrapper.getCanvas().classList.add("canvas-touch-none")}},{key:"getPointFromTouchyEvent",value:function(e){var t,n;return window.TouchEvent&&e instanceof TouchEvent?(t=e.touches[0].clientY,n=e.touches[0].clientX):(t=e.clientY,n=e.clientX),t+=window.scrollY,n+=window.scrollX,{y:t-this.offsetY,x:n-this.offsetX}}},{key:"onMouseDown",value:function(e){var t=this;sn(this.upperWrapper.getCanvas(),rn,"mousemove",this.onMouseMove),this.dragStatus=yn.Drag;var n=this.getPointFromTouchyEvent(e);this.worker.mousedown(n,(function(e){t.emit("mousedown",e)}))}},{key:"onMouseMove",value:function(e){var t=this,n=this.getPointFromTouchyEvent(e);this.isOutside(n)?this.onMouseUp():this.dragStatus!==yn.Stop&&this.worker.mousemove(n,(function(e){t.emit("mousemove",e)}))}},{key:"onMouseUp",value:function(){sn(this.upperWrapper.getCanvas(),on,"mousemove",this.onMouseMove),this.dragStatus=yn.Stop,this.worker.mouseup(),this.emit("mouseup")}},{key:"onMouseOut",value:function(){this.dragStatus=yn.Stop,this.worker.flushTask(),this.emit("mouseout")}},{key:"updateMetadata",value:function(e,t){var n=this;this.clear(this.lowerWrapper),this.update((function(e){n.drawAll(e.shapes)})),this.metadataMap.set(e,JSON.parse(t.board||"{}"));var a,r=Object(bt.a)(this.metadataMap.values());try{for(r.s();!(a=r.n()).done;){var o=a.value.eraserPoints;o&&o.length>0&&Yt(this.lowerWrapper.getContext(),{type:"eraser",points:o})}}catch(i){r.e(i)}finally{r.f()}}},{key:"isOutside",value:function(e){return e.y<0||e.x<0||e.y>this.lowerWrapper.getHeight()||e.x>this.lowerWrapper.getWidth()}},{key:"drawAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lowerWrapper;this.clear(t);var n,a=Object(bt.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;"line"===r.type?Vt(t.getContext(),r):"eraser"===r.type?Yt(t.getContext(),r):"rect"===r.type&&an(t.getContext(),r)}}catch(o){a.e(o)}finally{a.f()}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lowerWrapper;e.clear()}},{key:"clearBoard",value:function(){this.clear(this.lowerWrapper),this.clear(this.upperWrapper),this.worker.clearAll()}}]),n}(Ht);function Cn(e){var t=e.width,n=e.height,a=Object(i.useRef)(null),r=Object(i.useRef)(null),o=Object(u.b)(),s=Object(u.c)((function(e){return e.docState.client})),l=Object(u.c)((function(e){return e.docState.doc})),d=Object(u.c)((function(e){return e.boardState.toolType})),h=Object(u.c)((function(e){return e.boardState.color}));return Object(i.useEffect)((function(){if(!a.current)return function(){};var e=new xn(a.current,l.update.bind(l));return r.current=e,function(){e.destroy()}}),[l]),Object(i.useEffect)((function(){if(!l)return function(){};var e=l.subscribe((function(e){var t;"remote-change"===e.type&&(null===(t=r.current)||void 0===t||t.drawAll(l.getRoot().shapes))}));return function(){e()}}),[l]),Object(i.useEffect)((function(){var e,t,n,a;if(!s||!l)return function(){};var o=s.subscribe((function(e){if("peers-changed"===e.type)for(var t=l.getKey(),n=e.value[t],a=0,o=Object.keys(n);a<o.length;a++){var i,c=o[a];null===(i=r.current)||void 0===i||i.updateMetadata(c,n[c])}})),i=s.getID(),c=function(e){var t,n=JSON.stringify(e||"");null===(t=r.current)||void 0===t||t.updateMetadata(i,{board:n}),null===s||void 0===s||s.updatePresence("board",n)};return null===(e=r.current)||void 0===e||e.addEventListener("mousemove",c),null===(t=r.current)||void 0===t||t.addEventListener("mousedown",c),null===(n=r.current)||void 0===n||n.addEventListener("mouseout",c),null===(a=r.current)||void 0===a||a.addEventListener("mouseup",c),function(){var e,t,n,a;o(),null===(e=r.current)||void 0===e||e.removeEventListener("mousemove",c),null===(t=r.current)||void 0===t||t.removeEventListener("mousedown",c),null===(n=r.current)||void 0===n||n.removeEventListener("mouseout",c),null===(a=r.current)||void 0===a||a.removeEventListener("mouseup",c)}}),[l]),Object(i.useEffect)((function(){var e,t=function(){d===Mt.Rect&&o(It(Mt.Selector))};return null===(e=r.current)||void 0===e||e.addEventListener("mouseup",t),function(){var e;null===(e=r.current)||void 0===e||e.removeEventListener("mouseup",t)}}),[l,d]),Object(i.useEffect)((function(){var e,o,i;a.current&&(null===(e=r.current)||void 0===e||e.setWidth(t),null===(o=r.current)||void 0===o||o.setHeight(n),null===(i=r.current)||void 0===i||i.drawAll(l.getRoot().shapes))}),[l,t,n]),Object(i.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.setTool(d)}),[l,d]),Object(i.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.setColor(h)}),[l,h]),Object(i.useEffect)((function(){var e;d===Mt.Clear&&(null===(e=r.current)||void 0===e||e.clearBoard(),o(It(Mt.None)))}),[l,d]),c.a.createElement("canvas",{ref:a})}var Sn=n(512),Mn=n(229),Dn=n.n(Mn),Tn=n(232),Ln=n.n(Tn),Nn=n(230),zn=n.n(Nn),In=n(231),Wn=n.n(In),Rn=n(233),Pn=n.n(Rn),Bn=n(128);function An(e){var t=e.fontSize;return c.a.createElement(Bn.a,{fontSize:t},c.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 480.001 480.001"},c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("path",{d:"M333.142,350.846c0.115-0.115,0.215-0.239,0.323-0.357l129.681-129.706c10.878-10.878,16.864-25.368,16.855-40.8 c-0.01-15.409-5.999-29.865-16.854-40.694l-97.844-97.874c-10.853-10.845-25.326-16.817-40.75-16.817 c-15.426,0-29.895,5.974-40.741,16.82L16.855,308.329C5.974,319.21-0.012,333.713,0,349.168 c0.013,15.425,6.002,29.884,16.854,40.7l62.592,62.606c0.061,0.061,0.127,0.112,0.188,0.171c0.174,0.165,0.349,0.331,0.534,0.483 c0.082,0.067,0.171,0.126,0.255,0.19c0.175,0.135,0.349,0.271,0.532,0.395c0.07,0.047,0.145,0.085,0.215,0.13 c0.205,0.131,0.412,0.26,0.627,0.376c0.051,0.026,0.103,0.048,0.154,0.074c0.239,0.123,0.482,0.241,0.732,0.346 c0.033,0.014,0.067,0.024,0.101,0.037c0.269,0.108,0.54,0.208,0.819,0.293c0.034,0.011,0.07,0.017,0.104,0.027 c0.276,0.081,0.556,0.154,0.841,0.211c0.082,0.017,0.165,0.023,0.247,0.038c0.239,0.041,0.479,0.084,0.724,0.107 c0.33,0.033,0.663,0.051,0.998,0.051h137.91h159.308c5.522,0,10-4.478,10-10c0-5.522-4.478-10-10-10H248.566l84.22-84.236 C332.904,351.06,333.027,350.96,333.142,350.846z M220.285,435.404H90.66l-59.675-59.689 c-7.076-7.054-10.977-16.487-10.985-26.563c-0.008-10.106,3.897-19.582,10.996-26.681l129.825-129.803l151.091,151.091 L220.285,435.404z M174.965,178.527L297.953,55.56c7.069-7.069,16.516-10.963,26.6-10.963c10.085,0,19.536,3.895,26.609,10.962 l97.85,97.88c7.08,7.063,10.982,16.493,10.989,26.557c0.006,10.085-3.899,19.547-10.998,26.645l-122.95,122.974L174.965,178.527z"})))))}function Hn(e){var t=e.fontSize;return c.a.createElement(Bn.a,{fontSize:t},c.a.createElement("svg",{viewBox:"-36 0 392 392.40392",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"m43 355.03125c.492188 3.949219 3.273438 7.230469 7.085938 8.355469 3.816406 1.128906 7.933593-.109375 10.492187-3.152344l68.5-81.507813 72.972656 109.230469c3.058594 4.585938 9.25 5.828125 13.84375 2.777344l65.226563-43.285156c4.589844-3.046875 5.851562-9.234375 2.820312-13.835938l-72.304687-109.675781 101.714843-31.453125c3.800782-1.175781 6.542969-4.488281 6.984376-8.441406.441406-3.953125-1.5-7.792969-4.945313-9.777344l-300.195313-172.929687c-3.289062-1.894532-7.363281-1.765626-10.523437.332031-3.160156 2.097656-4.863281 5.804687-4.394531 9.566406zm242.539062-174.878906-92.539062 28.617187c-3.003906.929688-5.398438 3.21875-6.460938 6.179688-1.058593 2.960937-.664062 6.25 1.066407 8.875l74.152343 112.476562-48.613281 32.261719-74.832031-112.023438c-1.746094-2.617187-4.625-4.257812-7.765625-4.429687-.183594-.011719-.367187-.015625-.550781-.015625-2.953125 0-5.753906 1.308594-7.652344 3.566406l-62.320312 74.152344-37.421876-301.128906zm0 0"})))}function Fn(e){var t=e.fontSize;return c.a.createElement(Bn.a,{fontSize:t},c.a.createElement("svg",{enableBackground:"new 0 0 506.1 506.1",viewBox:"0 0 506.1 506.1",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"m489.609 506.1h-473.118c-9.108 0-16.491-7.384-16.491-16.491v-473.118c0-9.108 7.383-16.491 16.491-16.491h473.119c9.107 0 16.49 7.383 16.49 16.491v473.118c0 9.107-7.383 16.491-16.491 16.491zm-456.628-32.982h440.138v-440.137h-440.138z"})))}var Kn=n(527),Un=n(520),Vn=n(510),Yn=n(509),Gn=Object(z.a)((function(e){return Object(I.a)({root:{minWidth:"320px",borderRadius:"4px"},header:{borderBottom:"1px solid ".concat(e.palette.text.disabled)},title:{padding:"12px 16px"},list:{padding:"8px 18px 18px 18px",lineHeight:"19px"},item:{display:"flex",justifyContent:"space-between",fontSize:"15px",marginTop:"12px"},itemTitle:{whiteSpace:"nowrap",display:"flex",alignItems:"center"},itemInfo:{minWidth:140,paddingLeft:"12px",borderRadius:"4px",textAlign:"left"}})}));function Jn(){var e=Object(u.b)(),t=Gn(),n=Object(u.c)((function(e){return e.docState.doc})),s=Object(u.c)((function(e){return e.docState.preview})),l=Object(u.c)((function(e){return e.settingState.menu}));Object(i.useEffect)((function(){if(!n)return function(){};var t=n.subscribe((function(t){"remote-change"===t.type&&e($e(n.getRoot().preview||De.HTML))}));return function(){t()}}),[n]);var d=Object(i.useCallback)((function(t){if(n){var a=t.target.value;n.update((function(e){e.preview=a})),e($e(a))}}),[n,e]);function h(t){return function(n){e(t(n.target.value))}}var f=Object(i.useCallback)((function(t,n){e(D(n))}),[e,D]);return c.a.createElement("div",{className:t.root},c.a.createElement(ie.a,null,c.a.createElement("header",{className:t.header},c.a.createElement(B.a,{className:t.title,variant:"h6"},"Settings"))),c.a.createElement("div",{className:t.list},c.a.createElement("div",{className:t.item},c.a.createElement("div",{className:t.itemTitle},"Preview"),c.a.createElement(Yn.a,{className:t.itemInfo},c.a.createElement(Un.a,{name:"preview",value:s,onChange:d,displayEmpty:!0},Object.entries(De).map((function(e){var t=Object(A.a)(e,2),n=t[0],a=t[1];return c.a.createElement(Vn.a,{value:a,key:a},n)}))))),c.a.createElement("div",{className:t.item},c.a.createElement("div",{className:t.itemTitle},"Tab Size"),c.a.createElement(Yn.a,{className:t.itemInfo},c.a.createElement(Un.a,{value:l.tabSize,onChange:h(L),displayEmpty:!0},Object.entries(o).map((function(e){var t=Object(A.a)(e,2),n=t[0],a=t[1];return c.a.createElement(Vn.a,{value:a,key:n},"".concat(a," spaces"))}))))),c.a.createElement("div",{className:t.item},c.a.createElement("div",{className:t.itemTitle},"Key Binding"),c.a.createElement(Yn.a,{className:t.itemInfo},c.a.createElement(Un.a,{value:l.codeKeyMap,onChange:h(T),displayEmpty:!0},Object.entries(r).map((function(e){var t=Object(A.a)(e,2),n=t[0],a=t[1];return c.a.createElement(Vn.a,{value:a,key:a},n)}))))),c.a.createElement("div",{className:t.item},c.a.createElement("div",{className:t.itemTitle},"Dark Mode"),c.a.createElement(Yn.a,{className:t.itemInfo},c.a.createElement(Kn.a,{checked:l.theme===a.Dark,onChange:f})))))}var Xn=n(511),$n=Object(z.a)((function(e){return Object(I.a)({button:{marginLeft:3,marginRight:3,padding:8},select:{marginLeft:3,marginRight:3,padding:8,color:e.palette.primary.main},box:{width:"184px",display:"flex",flexWrap:"wrap","& > *":{margin:e.spacing(1)}},colorIcon:{"&:hover":{cursor:"pointer"},width:e.spacing(3.1),height:e.spacing(3.1)},badge:{backgroundColor:function(e){return e.color}}})}));function qn(e){var t=e.toolType,n=e.Icon,a=e.tooltip,r=e.fontSize,o=Object(u.b)(),s=Object(u.c)((function(e){return e.boardState.toolType})),l=Object(u.c)((function(e){return e.boardState.color})),d=Object(i.useState)(),h=Object(A.a)(d,2),f=h[0],p=h[1],m=$n({color:l}),v=Object(i.useCallback)((function(e){p(e.currentTarget)}),[s]),b=Object(i.useCallback)((function(){p(void 0)}),[]),g=Object(i.useCallback)((function(e){s!==t?o(It(t)):v(e)}),[s,l]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(K.a,{title:a,arrow:!0,className:s===t?m.select:m.button},c.a.createElement(se.a,{"aria-label":a,onClick:g},s===t?c.a.createElement(Xn.a,{variant:"dot",classes:{badge:m.badge},anchorOrigin:{vertical:"bottom",horizontal:"right"}},c.a.createElement(n,{fontSize:r})):c.a.createElement(n,{fontSize:r}))),c.a.createElement(G,{anchorEl:f,onClose:b,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},c.a.createElement(ie.a,{p:2,className:m.box},Object.entries(St).map((function(e){var n,a=Object(A.a)(e,2),r=a[0],i=a[1],u=l===i&&s===t;return c.a.createElement(K.a,{key:r,title:r,arrow:!0},c.a.createElement(ie.a,{border:3,borderRadius:"50%",borderColor:u?"primary.main":""},c.a.createElement(H.a,{className:m.colorIcon,style:{backgroundColor:i},onClick:(n=i,function(){o(It(t)),o(Wt(n)),b()})}," ")))})))))}var _n=Object(z.a)((function(e){return Object(I.a)({root:{marginTop:60,display:"flex",flexDirection:"column"},divider:{marginTop:5,marginBottom:5},button:{marginLeft:3,marginRight:3,padding:8},select:{marginLeft:3,marginRight:3,padding:8,color:e.palette.primary.main}})}));function Qn(){var e=_n(),t=Object(u.b)(),n=Object(u.c)((function(e){return e.boardState.toolType})),a=Object(i.useState)(),r=Object(A.a)(a,2),o=r[0],s=r[1],l=function(e){return function(){t(It(e))}},d=Object(i.useCallback)((function(e){s(e.currentTarget)}),[]),h=Object(i.useCallback)((function(){s(void 0)}),[]);return c.a.createElement("div",{className:e.root},c.a.createElement(K.a,{title:"Code",arrow:!0,className:n===Mt.None?e.select:e.button},c.a.createElement(se.a,{"aria-label":"Code",onClick:l(Mt.None)},c.a.createElement(Dn.a,{fontSize:"small"}))),c.a.createElement(qn,{toolType:Mt.Line,Icon:zn.a,fontSize:"small",tooltip:"Brush"}),c.a.createElement(qn,{toolType:Mt.Rect,Icon:Fn,fontSize:"small",tooltip:"Shape"}),c.a.createElement(K.a,{title:"Selector",arrow:!0,className:n===Mt.Selector?e.select:e.button},c.a.createElement(se.a,{"aria-label":"selector",onClick:l(Mt.Selector)},c.a.createElement(Hn,{fontSize:"small"}))),c.a.createElement(K.a,{title:"Eraser",arrow:!0,className:n===Mt.Eraser?e.select:e.button},c.a.createElement(se.a,{"aria-label":"eraser",onClick:l(Mt.Eraser)},c.a.createElement(An,{fontSize:"small"}))),c.a.createElement(K.a,{title:"Clear",arrow:!0,className:e.button},c.a.createElement(se.a,{"aria-label":"selector",onClick:l(Mt.Clear)},c.a.createElement(Wn.a,{fontSize:"default"}))),c.a.createElement(Sn.a,{className:e.divider}),c.a.createElement(K.a,{title:"Settings",arrow:!0},c.a.createElement(se.a,{"aria-label":"settings",onClick:d},c.a.createElement(Ln.a,{fontSize:"small"}))),c.a.createElement(K.a,{title:"GitHub",arrow:!0,className:e.button},c.a.createElement(se.a,{"aria-label":"selector",href:"https://github.com/yorkie-team/codepair"},c.a.createElement(Pn.a,{fontSize:"default"}))),c.a.createElement(G,{anchorEl:o,onClose:h},c.a.createElement(Jn,null)))}var Zn=64,ea=Object(z.a)((function(){return Object(I.a)({root:{flexGrow:1,display:"flex"},editor:{width:"calc(100% - ".concat(46,"px)"),flex:"0 0 auto"},codeEditor:{width:"100%",height:"calc(100vh - ".concat(Zn,"px)")},canvas:{top:Zn,height:"calc(100vh - ".concat(Zn,"px)"),width:"calc(100% - ".concat(46,"px)"),position:"fixed",pointerEvents:function(e){return e===Mt.None?"none":"auto"}}})}));function ta(e){var t=e.tool,n=ea(t),a=Object(i.useState)(0),r=Object(A.a)(a,2),o=r[0],s=r[1],l=Object(i.useState)(0),u=Object(A.a)(l,2),d=u[0],h=u[1],f=Object(i.useRef)(null),p=Object(i.useRef)(null),m=Object(i.useCallback)((function(){var e;t===Mt.None&&(null===(e=p.current)||void 0===e||e.focus())}),[t]);return Object(i.useEffect)((function(){var e=function(){var e;if(f.current){var t=null===(e=f.current)||void 0===e?void 0:e.getBoundingClientRect();s(t.width),h(t.height)}};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),c.a.createElement("div",{className:n.root,onClick:m,"aria-hidden":"true"},c.a.createElement("div",{className:n.editor,ref:f},c.a.createElement("div",{className:n.codeEditor},c.a.createElement(Tt,{forwardedRef:p})),c.a.createElement("div",{className:n.canvas},c.a.createElement(Cn,{width:o,height:d}))),c.a.createElement(Qn,null))}var na=Object(z.a)((function(){return Object(I.a)({loading:{display:"flex",height:"calc(100vh - ".concat(Zn,"px)"),alignItems:"center",justifyContent:"center"}})})),aa=function(e){var t=e.docKey,n=na(),a=Object(u.b)(),r=Object(u.c)((function(e){return e.docState.client})),o=Object(u.c)((function(e){return e.docState.doc})),s=Object(u.c)((function(e){return e.docState.status})),l=Object(u.c)((function(e){return e.boardState.toolType})),d=Object(u.c)((function(e){return e.docState.loading})),h=Object(u.c)((function(e){return e.docState.errorMessage}));return Object(i.useEffect)((function(){return a(Fe()),function(){a(Ye())}}),[]),Object(i.useEffect)((function(){if(!r||!o)return function(){};var e=r.subscribe((function(e){if("peers-changed"===e.type){var t=o.getKey(),n=e.value[t];a(Z({myClientID:r.getID(),changedPeers:n}))}s===Le.Connect&&("status-changed"===e.type&&"deactivated"===e.value||"stream-connection-status-changed"===e.type&&"disconnected"===e.value||"document-synced"===e.type&&"sync-failed"===e.value)?a(_e(Le.Disconnect)):s===Le.Disconnect&&("peers-changed"===e.type||"documents-changed"===e.type||"status-changed"===e.type&&"activated"===e.value||"stream-connection-status-changed"===e.type&&"connected"===e.value||"document-synced"===e.type&&"synced"===e.value)&&a(_e(Le.Connect))}));return function(){e()}}),[r,o,s]),Object(i.useEffect)((function(){return a(Ge(t)),function(){a(Je())}}),[t]),Object(i.useEffect)((function(){function e(){return(e=Object(We.a)(Ie.a.mark((function e(){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&o){e.next=2;break}return e.abrupt("return");case 2:return a(Xe(!0)),e.next=5,a(Ke({client:r,doc:o}));case 5:a(qe(o.getRoot().mode||Te.Markdown)),a($e(o.getRoot().preview||De.HTML)),a(Xe(!1));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){a(Xe(!0))}}),[t,r,o]),h?c.a.createElement("div",null,c.a.createElement(pt.a,{open:!0,anchorOrigin:{vertical:"top",horizontal:"center"}},c.a.createElement(mt.a,{severity:"warning"},h||"fail to attach document"))):!d&&r&&o?c.a.createElement(ta,{tool:l}):c.a.createElement(ie.a,{className:n.loading},c.a.createElement(vt.a,{color:"inherit"}))},ra=Object(z.a)((function(){return Object(I.a)({root:{flexGrow:1}})}));function oa(e){var t=ra(),n=Object(h.e)(),a=e.match.params.docKey;return Object(i.useEffect)((function(){d.a.set({page:n.pathname}),d.a.pageview(n.pathname)}),[n]),c.a.createElement("div",{className:t.root},c.a.createElement(ft,null),c.a.createElement(aa,{docKey:a}))}var ia=Object(f.a)();p.a({dsn:"".concat("https://d287d6df8c6f423189266360055e6ca7@o553194.ingest.sentry.io/5680102"),release:"codepair@".concat("7d52252"),integrations:[new v.a.BrowserTracing({routingInstrumentation:m.a(ia)})],tracesSampleRate:1});var ca=function(){var e=Object(u.c)((function(e){return e.settingState.menu})),t=Object(i.useMemo)((function(){return Object(g.a)({palette:{type:e.theme===a.Dark?"dark":"light",primary:{main:"#d8b01a"},secondary:{main:"#e6b602"}}})}),[e]),n=Object(i.useCallback)((function(){return c.a.createElement(h.a,{to:"/".concat(Math.random().toString(36).substring(7))})}),[]);return c.a.createElement(y.a,{theme:t},c.a.createElement(b.a,null),c.a.createElement(h.c,{history:ia},c.a.createElement(h.d,null,c.a.createElement(h.b,{path:"/",exact:!0,render:n}),c.a.createElement(h.b,{path:"/:docKey",exact:!0,component:oa}))))},sa=n(39),la=Object(sa.c)({docState:Qe,peerState:ee,settingState:N,boardState:Rt}),ua=Object(E.a)({reducer:la,middleware:Object(E.d)({serializableCheck:{ignoredActions:["doc/attach/fulfilled","doc/activate/fulfilled"],ignoredPaths:["docState.client","docState.doc"]},immutableCheck:{ignoredPaths:["docState.client","docState.doc"]}})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(445);var da="".concat("UA-42438082-5");da&&d.a.initialize(da),l.a.render(c.a.createElement(u.a,{store:ua},c.a.createElement(ca,null)),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[446,1,2]]]);
//# sourceMappingURL=main.8fb5fda1.chunk.js.map